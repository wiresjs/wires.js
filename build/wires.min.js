!function(){function a(){return"function"==typeof require&&"object"==typeof exports&&"object"==typeof module&&"string"==typeof __filename&&"string"==typeof __dirname}function b(a,b){this._options=b?b:{},void 0==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(a),this._handler=a,this.reset()}function c(a){c.super_.call(this,a,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function d(a,b){this.reset(),this._options=b?b:{},void 0==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),void 0==this._options.verbose&&(this._options.verbose=!0),void 0==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof a&&(this._callback=a)}function e(a,b){var c=function(){};c.prototype=b.prototype,a.super_=b,a.prototype=new c,a.prototype.constructor=a}if(!a()){if(this.Tautologistics){if(this.Tautologistics.NodeHtmlParser)return}else this.Tautologistics={};this.Tautologistics.NodeHtmlParser={},exports=this.Tautologistics.NodeHtmlParser}var f={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};b._reTrim=/(^\s+|\s+$)/g,b._reTrimComment=/(^\!--|--$)/g,b._reWhitespace=/\s/g,b._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,b._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,b._reTags=/[\<\>]/g,b.prototype.parseComplete=function(a){this.reset(),this.parseChunk(a),this.done()},b.prototype.parseChunk=function(a){this._done&&this.handleError(new Error("Attempted to parse chunk after parsing already done")),this._buffer+=a,this.parseTags()},b.prototype.done=function(){if(!this._done){if(this._done=!0,this._buffer.length){var a=this._buffer;this._buffer="";var c={raw:a,data:this._parseState==f.Text?a:a.replace(b._reTrim,""),type:this._parseState};(this._parseState==f.Tag||this._parseState==f.Script||this._parseState==f.Style)&&(c.name=this.parseTagName(c.data)),this.parseAttribs(c),this._elements.push(c)}this.writeHandler(),this._handler.done()}},b.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._elementsCurrent=0,this._current=0,this._next=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=f.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},b.prototype._options=null,b.prototype._handler=null,b.prototype._buffer=null,b.prototype._done=!1,b.prototype._elements=null,b.prototype._elementsCurrent=0,b.prototype._current=0,b.prototype._next=0,b.prototype._location=null,b.prototype._parseState=f.Text,b.prototype._prevTagSep="",b.prototype._tagStack=null,b.prototype.parseTagAttribs=function(a){for(var b=a.length,c=0;b>c;){var d=a[c++];(d.type==f.Tag||d.type==f.Script||d.type==f.style)&&this.parseAttribs(d)}return a},b.prototype.parseAttribs=function(a){if(a.type==f.Script||a.type==f.Style||a.type==f.Tag){var c=a.data.split(b._reWhitespace,1)[0],d=a.data.substring(c.length);if(!(d.length<1)){var e;for(b._reAttrib.lastIndex=0;e=b._reAttrib.exec(d);)void 0==a.attribs&&(a.attribs={}),"string"==typeof e[1]&&e[1].length?a.attribs[e[1]]=e[2]:"string"==typeof e[3]&&e[3].length?a.attribs[e[3].toString()]=e[4].toString():"string"==typeof e[5]&&e[5].length?a.attribs[e[5]]=e[6]:"string"==typeof e[7]&&e[7].length&&(a.attribs[e[7]]=e[7])}}},b.prototype.parseTagName=function(a){if(null==a||""==a)return"";var c=b._reTagName.exec(a);return c?(c[1]?"/":"")+c[2]:""},b.prototype.parseTags=function(){for(var a=this._buffer.length-1;b._reTags.test(this._buffer);){this._next=b._reTags.lastIndex-1;var c=this._buffer.charAt(this._next),d=this._buffer.substring(this._current,this._next),e={raw:d,data:this._parseState==f.Text?d:d.replace(b._reTrim,""),type:this._parseState},g=this.parseTagName(e.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==f.Script){if("/script"==g.toLowerCase())this._tagStack.pop();else if(0!=e.raw.indexOf("!--")&&(e.type=f.Text,this._elements.length&&this._elements[this._elements.length-1].type==f.Text)){var h=this._elements[this._elements.length-1];h.raw=h.data=h.raw+this._prevTagSep+e.raw,e.raw=e.data=""}}else if(this._tagStack[this._tagStack.length-1]==f.Style){if("/style"==g.toLowerCase())this._tagStack.pop();else if(0!=e.raw.indexOf("!--"))if(e.type=f.Text,this._elements.length&&this._elements[this._elements.length-1].type==f.Text){var h=this._elements[this._elements.length-1];""!=e.raw?(h.raw=h.data=h.raw+this._prevTagSep+e.raw,e.raw=e.data=""):h.raw=h.data=h.raw+this._prevTagSep}else""!=e.raw&&(e.raw=e.data=e.raw)}else if(this._tagStack[this._tagStack.length-1]==f.Comment){var i=e.raw.length;if("-"==e.raw.charAt(i-2)&&"-"==e.raw.charAt(i-1)&&">"==c)if(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==f.Comment){var h=this._elements[this._elements.length-1];h.raw=h.data=(h.raw+e.raw).replace(b._reTrimComment,""),e.raw=e.data="",e.type=f.Text}else e.type=f.Comment;else if(e.type=f.Comment,this._elements.length&&this._elements[this._elements.length-1].type==f.Comment){var h=this._elements[this._elements.length-1];h.raw=h.data=h.raw+e.raw+c,e.raw=e.data="",e.type=f.Text}else e.raw=e.data=e.raw+c}if(e.type==f.Tag){e.name=g;var j=g.toLowerCase();if(0==e.raw.indexOf("!--")){e.type=f.Comment,delete e.name;var i=e.raw.length;"-"==e.raw.charAt(i-1)&&"-"==e.raw.charAt(i-2)&&">"==c?e.raw=e.data=e.raw.replace(b._reTrimComment,""):(e.raw+=c,this._tagStack.push(f.Comment))}else 0==e.raw.indexOf("!")||0==e.raw.indexOf("?")?e.type=f.Directive:"script"==j?(e.type=f.Script,"/"!=e.data.charAt(e.data.length-1)&&this._tagStack.push(f.Script)):"/script"==j?e.type=f.Script:"style"==j?(e.type=f.Style,"/"!=e.data.charAt(e.data.length-1)&&this._tagStack.push(f.Style)):"/style"==j&&(e.type=f.Style);e.name&&"/"==e.name.charAt(0)&&(e.data=e.name)}(""!=e.raw||e.type!=f.Text)&&(this._options.includeLocation&&!e.location&&(e.location=this.getLocation(e.type==f.Tag)),this.parseAttribs(e),this._elements.push(e),e.type!=f.Text&&e.type!=f.Comment&&e.type!=f.Directive&&"/"==e.data.charAt(e.data.length-1)&&this._elements.push({raw:"/"+e.name,data:"/"+e.name,name:"/"+e.name,type:e.type})),this._parseState="<"==c?f.Tag:f.Text,this._current=this._next+1,this._prevTagSep=c}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=this._current<=a?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},b.prototype.getLocation=function(a){for(var b,c=this._location,d=this._current-(a?1:0),e=a&&0==c.charOffset&&0==this._current;c.charOffset<d;c.charOffset++)b=this._buffer.charAt(c.charOffset),"\n"==b?(c.inBuffer++,c.col=0):"\r"!=b&&c.col++;return{line:c.row+c.inBuffer+1,col:c.col+(e?0:1)}},b.prototype.validateHandler=function(a){if("object"!=typeof a)throw new Error("Handler is not an object");if("function"!=typeof a.reset)throw new Error("Handler method 'reset' is invalid");if("function"!=typeof a.done)throw new Error("Handler method 'done' is invalid");if("function"!=typeof a.writeTag)throw new Error("Handler method 'writeTag' is invalid");if("function"!=typeof a.writeText)throw new Error("Handler method 'writeText' is invalid");if("function"!=typeof a.writeComment)throw new Error("Handler method 'writeComment' is invalid");if("function"!=typeof a.writeDirective)throw new Error("Handler method 'writeDirective' is invalid")},b.prototype.writeHandler=function(a){if(a=!!a,!this._tagStack.length||a)for(;this._elements.length;){var b=this._elements.shift();switch(b.type){case f.Comment:this._handler.writeComment(b);break;case f.Directive:this._handler.writeDirective(b);break;case f.Text:this._handler.writeText(b);break;default:this._handler.writeTag(b)}}},b.prototype.handleError=function(a){if("function"!=typeof this._handler.error)throw a;this._handler.error(a)},e(c,d),c.prototype.done=function(){var a,b={},d=g.getElementsByTagName(function(a){return"rss"==a||"feed"==a},this.dom,!1);if(d.length&&(a=d[0]),a){if("rss"==a.name){b.type="rss",a=a.children[0],b.id="";try{b.title=g.getElementsByTagName("title",a.children,!1)[0].children[0].data}catch(e){}try{b.link=g.getElementsByTagName("link",a.children,!1)[0].children[0].data}catch(e){}try{b.description=g.getElementsByTagName("description",a.children,!1)[0].children[0].data}catch(e){}try{b.updated=new Date(g.getElementsByTagName("lastBuildDate",a.children,!1)[0].children[0].data)}catch(e){}try{b.author=g.getElementsByTagName("managingEditor",a.children,!1)[0].children[0].data}catch(e){}b.items=[],g.getElementsByTagName("item",a.children).forEach(function(a){var c={};try{c.id=g.getElementsByTagName("guid",a.children,!1)[0].children[0].data}catch(d){}try{c.title=g.getElementsByTagName("title",a.children,!1)[0].children[0].data}catch(d){}try{c.link=g.getElementsByTagName("link",a.children,!1)[0].children[0].data}catch(d){}try{c.description=g.getElementsByTagName("description",a.children,!1)[0].children[0].data}catch(d){}try{c.pubDate=new Date(g.getElementsByTagName("pubDate",a.children,!1)[0].children[0].data)}catch(d){}b.items.push(c)})}else{b.type="atom";try{b.id=g.getElementsByTagName("id",a.children,!1)[0].children[0].data}catch(e){}try{b.title=g.getElementsByTagName("title",a.children,!1)[0].children[0].data}catch(e){}try{b.link=g.getElementsByTagName("link",a.children,!1)[0].attribs.href}catch(e){}try{b.description=g.getElementsByTagName("subtitle",a.children,!1)[0].children[0].data}catch(e){}try{b.updated=new Date(g.getElementsByTagName("updated",a.children,!1)[0].children[0].data)}catch(e){}try{b.author=g.getElementsByTagName("email",a.children,!0)[0].children[0].data}catch(e){}b.items=[],g.getElementsByTagName("entry",a.children).forEach(function(a){var c={};try{c.id=g.getElementsByTagName("id",a.children,!1)[0].children[0].data}catch(d){}try{c.title=g.getElementsByTagName("title",a.children,!1)[0].children[0].data}catch(d){}try{c.link=g.getElementsByTagName("link",a.children,!1)[0].attribs.href}catch(d){}try{c.description=g.getElementsByTagName("summary",a.children,!1)[0].children[0].data}catch(d){}try{c.pubDate=new Date(g.getElementsByTagName("updated",a.children,!1)[0].children[0].data)}catch(d){}b.items.push(c)})}this.dom=b}c.super_.prototype.done.call(this)},d._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},d.reWhitespace=/^\s*$/,d.prototype.dom=null,d.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},d.prototype.done=function(){this._done=!0,this.handleCallback(null)},d.prototype.writeTag=function(a){this.handleElement(a)},d.prototype.writeText=function(a){this._options.ignoreWhitespace&&d.reWhitespace.test(a.data)||this.handleElement(a)},d.prototype.writeComment=function(a){this.handleElement(a)},d.prototype.writeDirective=function(a){this.handleElement(a)},d.prototype.error=function(a){this.handleCallback(a)},d.prototype._options=null,d.prototype._callback=null,d.prototype._done=!1,d.prototype._tagStack=null,d.prototype.handleCallback=function(a){if("function"==typeof this._callback)this._callback(a,this.dom);else if(a)throw a},d.prototype.isEmptyTag=function(a){var b=a.name.toLowerCase();return"/"==b.charAt(0)&&(b=b.substring(1)),this._options.enforceEmptyTags&&!!d._emptyTags[b]},d.prototype.handleElement=function(a){if(this._done&&this.handleCallback(new Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete a.raw,("tag"==a.type||"script"==a.type||"style"==a.type)&&delete a.data),this._tagStack.last())if(a.type!=f.Text&&a.type!=f.Comment&&a.type!=f.Directive)if("/"==a.name.charAt(0)){var b=a.name.substring(1);if(!this.isEmptyTag(a)){for(var c=this._tagStack.length-1;c>-1&&this._tagStack[c--].name!=b;);if(c>-1||this._tagStack[0].name==b)for(;c<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(a),this.isEmptyTag(a)||this._tagStack.push(a);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(a);else a.type!=f.Text&&a.type!=f.Comment&&a.type!=f.Directive?"/"!=a.name.charAt(0)&&(this.dom.push(a),this.isEmptyTag(a)||this._tagStack.push(a)):this.dom.push(a)};var g={testElement:function(a,b){if(!b)return!1;for(var c in a)if("tag_name"==c){if("tag"!=b.type&&"script"!=b.type&&"style"!=b.type)return!1;if(!a.tag_name(b.name))return!1}else if("tag_type"==c){if(!a.tag_type(b.type))return!1}else if("tag_contains"==c){if("text"!=b.type&&"comment"!=b.type&&"directive"!=b.type)return!1;if(!a.tag_contains(b.data))return!1}else if(!b.attribs||!a[c](b.attribs[c]))return!1;return!0},getElements:function(a,b,c,d){function e(a){return function(b){return b==a}}if(c=void 0===c||null===c||!!c,d=isNaN(parseInt(d))?-1:parseInt(d),!b)return[];var f,h=[];for(var i in a)"function"!=typeof a[i]&&(a[i]=e(a[i]));if(g.testElement(a,b)&&h.push(b),d>=0&&h.length>=d)return h;if(c&&b.children)f=b.children;else{if(!(b instanceof Array))return h;f=b}for(var j=0;j<f.length&&(h=h.concat(g.getElements(a,f[j],c,d)),!(d>=0&&h.length>=d));j++);return h},getElementById:function(a,b,c){var d=g.getElements({id:a},b,c,1);return d.length?d[0]:null},getElementsByTagName:function(a,b,c,d){return g.getElements({tag_name:a},b,c,d)},getElementsByTagType:function(a,b,c,d){return g.getElements({tag_type:a},b,c,d)}};exports.Parser=b,exports.DefaultHandler=d,exports.RssHandler=c,exports.ElementType=f,exports.DomUtils=g}();var Wires=Wires||{};!function(){"use strict";Wires.Config={viewsFolder:"/app/views/"}}();var Wires=Wires||{};!function(){var a=Wires.Events={on:function(a,b,d){if(!c(this,"on",a,[b,d])||!b)return this;this._events||(this._events={});var e=this._events[a]||(this._events[a]=[]);return e.push({callback:b,context:d,ctx:d||this}),this},once:function(a,b,d){if(!c(this,"once",a,[b,d])||!b)return this;var e=this,f=_.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,d)},off:function(a,b,d){if(!this._events||!c(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events=void 0,this;for(var e=a?[a]:_.keys(this._events),f=0,g=e.length;g>f;f++){a=e[f];var h=this._events[a];if(h)if(b||d){for(var i=[],j=0,k=h.length;k>j;j++){var l=h[j];(b&&b!==l.callback&&b!==l.callback._callback||d&&d!==l.context)&&i.push(l)}i.length?this._events[a]=i:delete this._events[a]}else delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=arguments;if(!c(this,"trigger",a,b))return this;var e=this._events[a],f=this._events.all;return e&&d(e,b),f&&d(f,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var f in d)a=d[f],a.off(b,c,this),(e||_.isEmpty(a._events))&&delete this._listeningTo[f];return this}},b=/\s+/,c=function(a,c,d,e){if(!d)return!0;if("object"==typeof d){for(var f in d)a[c].apply(a,[f,d[f]].concat(e));return!1}if(b.test(d)){for(var g=d.split(b),h=0,i=g.length;i>h;h++)a[c].apply(a,[g[h]].concat(e));return!1}return!0},d=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},e={listenTo:"on",listenToOnce:"once"};_.each(e,function(b,c){a[c]=function(a,c,d){var e=this._listeningTo||(this._listeningTo={}),f=a._listenId||(a._listenId=_.uniqueId("l"));return e[f]=a,d||"object"!=typeof c||(d=this),a[b](c,d,this),this}}),a.bind=a.on,a.unbind=a.off}();var Wires=Wires||{};!function(){var a=function(a,b){var c,d=this;c=a&&_.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},_.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&_.extend(c.prototype,a),c.__super__=d.prototype,c.prototype.__parent__=function(a,b){c.__super__[a].apply(c.prototype,b)},c},b=function(){if(this.initialize){var a=this;this._delayedInitialization?this._delayedInitialization(function(){a.__initializationResolved||(a.initialize.apply(a,arguments),a.__initializationResolved=!0)}):this.initialize.apply(this,arguments)}};b.extend=a,_.extend(b.prototype,Wires.Events),Wires.Class=b}();var Wires=Wires||{};!function(){console.log(1),Wires.Form=Wires.Class.extend({initialize:function(a){var b=this;_.each(a,function(a,c){b[c]=a})},reset:function(){var a=this;_.each(this,function(b,c){a.hasOwnProperty(c)&&0!==!c.indexOf("_")&&(a[c]=null)})},getValues:function(){var a={},b=this;return _.each(this,function(c,d){b.hasOwnProperty(d)&&0!==!d.indexOf("_")&&(a[d]=c)}),a}})}();var Wires=Wires||{};!function(){"use strict";Wires.Debug=Wires.Class.extend({},{enabled:!1,showError:function(a,b){a&&this.enabled&&this.showStack(a,b)},showStack:function(a,b){var c=$(' <div id="wires-debug" style="position:fixed;z-index:99999;top:0; width:100%; height:100%; background-color: rgb(0, 0, 0);  background-color: rgba(0, 0, 0, 0.6);">\n        <div style="overflow-y: auto;position:absolute;padding:10px;width:1000px; height:320px;  border:3px solid red; left:50%;margin-left: -500px; top:200px;background-color:white">\n            <div style="margin:10px;font-size:30px; color:red">Wires.debugger</div>\n             \n<pre class=\'func\'></pre>           <pre class=\'stack\' style="height:200px; ">\n    </pre>\n        </div>\n        \n    </div>');c.find(".stack").html(a.stack?a.stack:a),b&&c.find(".func").html(b),c.click(function(a){"wires-debug"===$(a.target).attr("id")&&c.remove()}),c.prependTo("body")}})}(),Object.prototype.watch||Object.defineProperty(Object.prototype,"watch",{enumerable:!1,configurable:!0,writable:!1,value:function(a,b){var c=this[a],d=c,e=function(){return d},f=function(e){return c=d,d=b.call(this,a,c,e)};delete this[a]&&Object.defineProperty(this,a,{get:e,set:f,enumerable:!0,configurable:!0})}}),id_counter=1,Object.defineProperty(Object.prototype,"__uniqueId",{writable:!0}),Object.defineProperty(Object.prototype,"uniqueId",{get:function(){return void 0==this.__uniqueId&&(this.__uniqueId=id_counter++),this.__uniqueId}}),Object.prototype.unwatch||Object.defineProperty(Object.prototype,"unwatch",{enumerable:!1,configurable:!0,writable:!1,value:function(a){var b=this[a];delete this[a],this[a]=b}}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var Wires=Wires||{};!function(){"use strict";Wires.Acts=function(a){this.node=a}}();var Wires=Wires||{};!function(){"use strict";Wires.Acts.prototype.toggle=function(a,b){var c=this.node.scope.instance;void 0===b?b=a:c=a,c[b]=c[b]?!1:!0}}();var Wires=Wires||{};!function(){"use strict";Wires.Node=Wires.Class.extend({bindEssentials:function(a){var b=this;this.variables=Wires.Variable.extract(this.scope,a),this.template=a,this.variables.length>0?_.each(this.variables,function(a){Wires.Watcher.spy(b.scope,a,b)}):this.setValue()},compileValue:function(a,b){var c=this.template,d={};return _.each(this.variables,function(e){var f=e.getValue(a,b);void 0!==b&&(f=e.equalsTo(a)?b:f),void 0!==f&&(d[e.tag]=f,c=c.split(e.name).join(void 0!==f&&null!==f?f.toString():""))}),c}})}();var Wires=Wires||{};!function(){"use strict";Wires.Attr=Wires.Node.extend({initialize:function(a,b,c,d){this.instance=a.instance,this.scope=a,this.element=c,this.attr=d,this.bindEssentials(this.attr.value)},setValue:function(a,b){var c=this.compileValue(a,b);this.attr.value=c},executeStatement:function(a,b,c){return Wires.Exec.expression({statement:this.attr.value,incomingVar:a,resultNeeded:c,newValue:b,scope:this.scope,variables:this.variables})}},{claimsChildren:!1,addAttibute:!0})}();var Wires=Wires||{};!function(){"use strict";Wires.TextNode=Wires.Node.extend({initialize:function(a,b,c){this.dom=b,this.scope=a,this.instance=a.instance,this.element=document.createTextNode(this.dom.data),this.bindEssentials(b.data);var d=this;c.appendChild(d.element),b.children&&Wires.World.parse(a,b.children,this.element)},setValue:function(a,b){var b=this.compileValue(a,b);this.element.nodeValue=b},getElement:function(){return this.element}})}();var Wires=Wires||{};!function(){"use strict";Wires.TagNode=Wires.Node.extend({initialize:function(a,b,c,d){this.dom=b,this.scope=a,this.instance=a.instance,this.attributes={},this.target=c,this.options=d},prepareNodeStructure:function(a){var b,c=this;if(b=Wires.Component.getCustomComponent(this.dom.name)){var d=new b;d.getDom(this.dom,function(b){_.each(c.dom.attribs,function(a,b){var e=Wires.Exec.expression({statement:a,scope:c.scope,variables:Wires.Variable.extract(c.scope,a)});d[b]=e}),d.__resolveInitialization(),c.dom.children=b,c.scope=Wires.World.attachParents(c.scope,d),a()})}else a()},create:function(a){var b=this.options,c=this.target,d=this.dom,e=this;this.element=this.getElement(),$(this.element).data("wires-node",this),this.prepareNodeStructure(function(){b&&b.insertBefore?($(this.element).insertBefore(b.insertBefore),Wires.World.parse(e.scope,d.children,this.element)):(this.shouldAppendElement||(this.attributeClamsChildren=!0),d.children&&!this.attributeClamsChildren&&Wires.World.parse(e.scope,d.children,this.element),this.shouldAppendElement?c.appendChild(this.element):this.placeholders=!0),this.placeholders&&(this.placeholderBefore=document.createComment(""),c.appendChild(this.placeholderBefore),this.placeholderAfter=document.createComment(""),c.appendChild(this.placeholderAfter)),_.each(this.attributes,function(a){a.onElementReady&&a.onElementReady(e)}),a()}.bind(this))},bindAttribute:function(a,b){new Wires.Attr(this.scope,this.dom,b,a)},getElement:function(){var a=document.createElement(this.dom.name),b=this;this.shouldAppendElement=!0;var c=!1,d=[];return _.each(this.dom.attribs,function(e,f){if(c)return!1;var g=document.createAttribute(f);g.value=e;var h=!0;if(Wires.attrs[f]){var i=Wires.attrs[f];d.push({handler:i,attr:g}),i.claimsChildren===!0&&(b.attributeClamsChildren=!0),i.placeholders&&(b.placeholders=!0),void 0!==i.shouldAppendElement&&(b.shouldAppendElement=i.shouldAppendElement),void 0!==i.ignoreRestAttributes&&(c=i.ignoreRestAttributes),h=i.addAttibute}else e.indexOf("$")>-1&&b.bindAttribute(g,a);h&&a.setAttributeNode(g)}),_.each(d,function(c){var d=new c.handler(b.scope,b.dom,a,c.attr,b);void 0!==c.handler.persistWatch&&(d.persistWatch=c.handler.persistWatch),b.attributes[c.attr.nodeName]=d}),a}})}();var Wires=Wires||{};!function(){"use strict";Wires.World=Wires.Class.extend({initialize:function(a){this.template=a.template,this.target=a.target,this.scope=a.scope;var b=this,c=new Tautologistics.NodeHtmlParser.DefaultHandler(function(a,c){a?console.log(a):Wires.World.parse(b.scope,c,b.target)}),d=new Tautologistics.NodeHtmlParser.Parser(c);d.parseComplete(this.template)}},{cleanUp:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},attachParents:function(a,b,c){var d=a.instance,e={instance:b,parents:[d],parent:a.instance,param:c};return void 0!==c&&(e.instance={},e.instance[c]=b),a.parents&&(e.parents=_.union(e.parents,a.parents)),e},parse:function(a,b,c,d){var e,f=function(g){void 0===g&&b.length>0&&(g=0);var h=b[g];"text"===h.type&&(e=new Wires.TextNode(a,h,c,d),g<b.length-1&&(g++,f(g))),"tag"===h.type&&(e=new Wires.TagNode(a,h,c,d),e.create(function(){g<b.length-1&&(g++,f(g))}))};return b.length>0&&f(),e}})}();var Wires=Wires||{};!function(){"use strict";Wires.Exec=Wires.Class.extend({},{expression:function(options){var statement=options.statement,incomingVar=options.incomingVar,resultNeeded=void 0!==options.resultNeeded?options.resultNeeded:!0,newValue=options.newValue,scope=options.scope,variables=options.variables,data={};_.each(variables,function(a){var b=a.getValue?a.getValue():a;void 0===newValue||a.service||(b=a.equalsTo(incomingVar)?newValue:b);var c=a.name.replace(/[\[.\]]/gi,"_");data[c]=b,statement=statement.split(a.name).join(c)});var func="(function("+_.keys(data)+"){ "+(resultNeeded?"return":"")+" "+statement+"})",result="",_this=this.getThisPointer(scope);try{result=eval(func).apply(_this,_.values(data))}catch(e){this.failedMessage(e,{message:"Failed to execute expression",code:statement,scope:scope,variables:data,func:func})}return result},variable:function(param){return eval("(function(){return this."+param+"})")},getThisPointer:function(a){var b=a.instance;return(a.parent||a.parents)&&(b=a.instance,b.parent=a.parent,b.parents=a.parents),b},failedMessage:function(a,b){Wires.Debug.showError(a,b.func),console.groupCollapsed(b.message,b.param||""),console.error(a.message),console.error(a.stack?a.stack:a),b.code&&console.error(b.code),b.variables&&console.error("Local variables",b.variables),b.target&&(console.error("Destination instance:",b.target||{}),console.error("Destination property:",b.target.property||{})),console.error("Registered scope:",b.scope||{}),b.scope&&b.scope.parent&&console.info("Maybe you meant $parent?"),console.groupEnd()}})}();var Wires=Wires||{};!function(){"use strict";var a=function(a,b){var c=new RegExp(/^(parent\.|parents\[(\d{1,4})\]\.)/m),d=a.match(c),e=b.instance;if(d){var f;(f=parseInt(d[2]))>0?b.parent&&b.parents.length>=f&&(e=b.parents[f]):e=b.parent,a=a.replace(c,"")}return{instance:e,path:a}},b=function(b,c){var d=a(c,b),e=d.instance,f=d.path,c=f.split(".");if(1===c.length)return{instance:e,property:c[0]};var g=e,h=null;return _.each(c,function(a,b){void 0!==g[a]&&b<c.length-1&&(g=g[a]),b===c.length-1&&(h=a)}),{instance:g,property:h}};Wires.Variable=Wires.Class.extend({initialize:function(a,c,d){return this.instance=a.instance,this.parent=a.parent,this.scope=a,this.isFunction=!1,this.name=c,d?(this.expression=c.replace("{#","").replace("#}",""),void(this.expressionVariables=d.variables)):(this.param=c.substring(1),c.indexOf("(")>-1&&(this.isFunction=!0),this.target=b(this.scope,this.param),void this.compileFunction())},compileFunction:function(){this.compiledFunction=Wires.Exec.variable(this.param)},equalsTo:function(a){return this.target&&a.target&&this.target.instance.uniqueId==a.target.instance.uniqueId&&this.target.param==a.target.param?!0:a.name===this.name},_executeFunction:function(){var a=this.compiledFunction,b=Wires.Exec.getThisPointer(this.scope),c="";try{c=a.apply(b)}catch(d){Wires.Exec.failedMessage(d,{message:"Failed to execute",param:this.expression?this.expression:this.param,target:this.target,scope:this.scope})}return c},getTrickedValue:function(){var a=this.getValue();return Wires.VariableTricks.changeWatchableTarget(a)},getValue:function(a,b){return this.expression?Wires.Exec.expression({statement:this.expression,incomingVar:a,newValue:b,scope:this.scope,variables:this.expressionVariables}):_.isObject(this.target.instance)?this.isFunction||void 0===this.target.instance[this.target.property]?this.isFunction?this._executeFunction():"":this._executeFunction():this.target.instance},setValue:function(a){this.target.instance[this.target.property]=a}},{getTargetVariable:b,extract:function(a,b){var c=b.match(/(\$[a-zA-Z0-9_.\[\]]+(\([$\w,\s'".]*\))?)/g),d=[];c&&(c=_.uniq(c),_.each(c,function(b){d.push(new Wires.Variable(a,b))}));var e=[];c=b.match(/(\{#(.+?)#\})/g),c&&(c=_.uniq(c),_.each(c,function(b){e.push(new Wires.Variable(a,b,{variables:d}))}));var f=[];return _.each(e,function(a){f.push(a)}),_.each(d,function(a){f.push(a)}),f}})}();var Wires=Wires||{};!function(){"use strict";Wires.Watcher=Wires.Class.extend({initialize:function(a,b,c){if(this.nodeCollection={},this.index=1,this.node=a,this.variable=b,this.instanceId=c,!this.variable.isFunction&&!this.variable.expression){var d=b.target.instance,e=b.target.property;d.watch(e,function(a,b,c){this.valueChanged(c),d.onPropertyChanged&&_.defer(function(){d.onPropertyChanged(a,c)});var e="on"+a.charAt(0).toUpperCase()+a.slice(1)+"Changed";return d[e]&&_.defer(function(){d[e](c)}),c}.bind(this))}},valueChanged:function(a){var b=this;_.each(this.nodeCollection,function(c){c.setValue(b.variable,a)})},setInitial:function(a){a.setValue(this.variable,void 0,!0)},add:function(a){var b=this,c=this.index++,d=(a.element,this.node instanceof Wires.TextNode?a.element.parentNode||a.element:a.element);d.addEventListener("DOMNodeRemovedFromDocument",function(){var a=b.nodeCollection[this.index];a.persistWatch||delete b.nodeCollection[this.index]}.bind({index:c,node:a}),!1),this.nodeCollection[c]=a}},{collections:{},unwatch:function(a,b,c){console.log("unwatch",b,c.element)},spy:function(a,b,c){var d=a.instance,e=b.name;if(!b.expression){var e=b.target&&b.target.property?b.target.property:b.name;d=b.target&&b.target.instance?b.target.instance:d;var f=d.uniqueId;if(!this.collections[d.uniqueId]){var g=new Wires.Watcher(c,b);this.collections[f]=g}this.collections[f][e]||(this.collections[f][e]=new Wires.Watcher(c,b,f));var h=this.collections[f][e];h.add(c),h.setInitial(c)}}})}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";Wires.BaseAttribute=Wires.Attr.extend({initialize:function(a,b,c,d,e){this.scope=a,this.node=e,this.instance=a.instance,this.element=c,this.attr=d,this.condition=this.attr.value,this.bindEssentials(this.condition)}},{addAttibute:!1})}();var Wires=Wires||{};!function(){"use strict";Wires.VariableTricks=Wires.Class.extend({},{changeWatchableTarget:function(a){var b=a instanceof Wires.Collection;return b&&(a=a.array),a}})}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({initialize:function(){a.__super__.initialize.apply(this,arguments)},onElementReady:function(){this.node.placeholderBefore.nodeValue="wires-if: "+this.condition,this.node.placeholderAfter.nodeValue="/wires-if: "+this.condition},setValue:function(a,b){var c=this.executeStatement(a,b,"return"),d=$(this.element);c?(d.insertBefore(this.node.placeholderAfter),Wires.World.parse(this.scope,this.node.dom.children,this.element)):(d.empty(),d.remove())}},{persistWatch:!0,shouldAppendElement:!1,claimsChildren:!1});Wires.attrs["ws-if"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({setValue:function(a,b){var c=this.executeStatement(a,b,"return"),d=$(this.element).data("animation"),e=$(this.element);switch(d){case"slide":c?e.slideDown():e.slideUp();break;case"fade":c?e.fadeIn():e.fadeOut();break;default:c?e.show():e.hide()}}});Wires.attrs["ws-visible"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){var a=Wires.Attr.extend({initialize:function(a,b,c,d,e){this.instance=a.instance,this.scope=a,this.element=c,this.attr=d,this.node=e,this.dom=b,this.condition=this.attr.value,this.essentials=this.getEssentials();this.essentials.collection.getTrickedValue()._WiresEach;this.bindArrayEvents(!1),this.items=[],Wires.Watcher.spy(this.instance,this.essentials.collection,this)},onElementReady:function(){this.node.placeholderBefore.nodeValue="ws-repeat: "+this.condition,this.node.placeholderAfter.nodeValue="/ws-repeat: "+this.condition,this.delayedAddFunction&&(this.delayedAddFunction(),this.delayedAddFunction=void 0)},addItem:function(a){a[this.essentials.key.param]=function(){return this.array.indexOf(this.item)}.bind({array:this.array,item:a}),a.parent=this.instance;var b=this,c=_.cloneDeep(this.dom);delete c.attribs["ws-repeat"];var d=[c],e=Wires.World.attachParents(this.scope,a,b.essentials.value.param),f=Wires.World.parse(e,d,this.element,{insertBefore:this.node.placeholderAfter});this.items.push(f)},bindArrayEvents:function(a){var b=this.essentials.collection;this.array=b.getTrickedValue(),a&&(this.array._WiresEach=null),_.isArray(this.array)&&(this.array._WiresEach||(this.array._WiresEach=[],this.array._WiresRepeat=this,this.array.push=function(){var a=arguments.length>0?arguments[0]:null,b=Array.prototype.push.apply(this,arguments);
return a&&_.each(this._WiresEach,function(b){b.addItem(a)}),b},this.array.splice=function(a,b){return _.each(this._WiresEach,function(c){for(var d=a;a+b>d;d++)$(c.items[d].element).remove();c.items.splice(a,b)}),Array.prototype.splice.apply(this,arguments)}),this.array._WiresEach.push(this))},getArrayLength:function(){return this.array.length},getEssentials:function(){var a=Wires.Variable.extract(this.scope,this.condition);return a.length<2?void console.error("Can't recognize expression!"):{value:a[0],key:3===a.length?a[1]:{name:"$index",param:"index"},collection:a[3===a.length?2:1]}},_setValue:function(a,b){var c=this,d=b?b:a.getTrickedValue();_.isArray(d)&&c.dom.children&&_.each(d,function(a,b){c.addItem(a,b)})},removeElements:function(){for(var a=[],b=$(this.node.placeholderBefore);void 0!=b[0]&&b[0]!=this.node.placeholderAfter;)b=b.next(),a.push(b);_.each(a,function(a){a.remove()})},setValue:function(a,b,c){c?this.delayedAddFunction=function(){this._this._setValue.apply(this._this,this.args)}.bind({_this:this,args:arguments}):this._setValue.apply(this,arguments)}},{addAttibute:!1,ignoreRestAttributes:!0,shouldAppendElement:!1});Wires.attrs["ws-repeat"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.Attr.extend({initialize:function(b,c,d){a.__super__.initialize.apply(this,arguments),this.element=d,this.scope=b,this.instance=b.instance,this.bindChanges()},bindChanges:function(){var a=this,b=this.element.nodeName.toLowerCase(),c=$(this.element).attr("type");switch("textarea"===b&&(c=b),"select"===b&&(c=b),c){case"text":case"email":case"password":case"textarea":this.element.addEventListener("keydown",function(){clearInterval(a.interval),a.interval=setTimeout(function(){a.variables.length>0&&(a.ignoreNodeSetValue=!0,a.variables[0].setValue(this.value,{ignore:this.element}))}.bind(this),50)},!1);break;case"checkbox":this.element.addEventListener("click",function(){var b=this.checked;a.ignoreNodeSetValue=!0,a.variables[0].setValue(b)});break;case"select":$(this.element).bind("change",function(){var b=$(this).val(),c=$(this).find("option:selected");if(c.length){var d=$(c).data("wires-node"),e=d.attributes["ws-value"];e&&e.variables.length>0&&(b=e.variables[0].getValue())}a.ignoreNodeSetValue=!0,a.variables[0].setValue(b)})}},setValue:function(a,b){if(this.ignoreNodeSetValue)return void(this.ignoreNodeSetValue=!1);var c=this.executeStatement(a,b,"return"),d=this.element.getAttribute("type");"checkbox"===d?this.element.checked=c:this.element.value=c}},{addAttibute:!1});Wires.attrs["ws-value"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.Attr.extend({initialize:function(a,b,c,d){this.scope=a,this.element=c,this.attr=d,this.condition=this.attr.value,this.bindEssentials(this.condition);var e=this,f=new Wires.Acts(e);this.variables.push({getValue:function(){return f},service:!0,name:"act"}),this.bindEvents()},bindEvents:function(){$(this.element).click(function(){this.executeStatement.bind(this)("","",!1)}.bind(this))},setValue:function(){}},{addAttibute:!1});Wires.attrs["ws-click"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({initialize:function(){a.__super__.initialize.apply(this,arguments);var b=this.attr.value;$(this.element).data("animation",b)},setValue:function(){}});Wires.attrs["ws-animation"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({initialize:function(){a.__super__.initialize.apply(this,arguments),this.setBindings()},setBindings:function(){$(this.element).submit(function(a){$(this.element).find("select").each(function(){var a=$(this).data("wires-node").attributes,b=a["ws-value"];if(b&&b.variables.length){var c=b.variables[0].getValue();if(void 0===c||""===c){var d=$(this).find("option:selected");if(d.length){var e=$(d).data("wires-node"),f=e.attributes["ws-value"];if(f&&f.variables.length>0){var g=f.variables[0].getValue();b.variables[0].setValue(g)}}}}}),this.executeStatement(),a.originalEvent.preventDefault()}.bind(this))}});Wires.attrs["ws-submit"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({initialize:function(){a.__super__.initialize.apply(this,arguments)},setValue:function(a,b){var c=this.executeStatement(a,b,"return"),d=$(this.element);c?d.attr("selected",""):d.removeAttr("selected")}},{addAttibute:!1});Wires.attrs["ws-selected"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({setValue:function(a,b){var c=this.executeStatement(a,b,"return"),d=this;_.each(c,function(a,b){a?$(d.element).addClass(b):$(d.element).removeClass(b)})}});Wires.attrs["ws-class"]=a}();var Wires=Wires||{};Wires.attrs=Wires.attrs||{},function(){"use strict";var a=Wires.BaseAttribute.extend({initialize:function(){a.__super__.initialize.apply(this,arguments),this.options=this.executeStatement(null,null,"return"),this.setBindings()},setBindings:function(){var a,b=this.options;$(this.element).sortable({axis:"y",start:function(b,c){a=c.item.position().top},update:function(a,c){var d=function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)},e=c.item,f=(e.position().top,b.property),g=b.autoSave;if(f){var h=e.next(),i=e.prev(),j=c.item.data("wires-node"),k=0,l=1;if(i.length){var m=i.data("wires-node"),n=Wires.Variable.getTargetVariable(m.scope,f);k=n.instance[n.property]}if(h.length){var m=h.data("wires-node"),n=Wires.Variable.getTargetVariable(m.scope,f);l=n.instance[n.property]}else l=k+1;var o=(l-k)/2+k;o=d(o,5);var p=Wires.Variable.getTargetVariable(j.scope,f);p.instance[p.property]=o,g&&p.instance.save()}}})}});Wires.attrs["ws-sortable"]=a}();var Wires=Wires||{};!function(){"use strict";Wires.Component=Wires.Class.extend({_delayedInitialization:function(a){this.__resolveInitialization=a},initialize:function(){},getDom:function(a,b){this.getDomStructure(a.name,function(c){Wires.Component.searchForComponentDataAttribute(c,a.children),b(c)})},getDomStructure:function(a,b){var c=this.view;if(Wires.Component[a])return void b(Wires.Component[a]);c&&Wires.MVC.fetchTemplate(this.view,function(c){Wires.DOM.getFromString(c,function(c){Wires.Component[a]=c,b(c)})});var d=this.template;d&&Wires.DOM.getFromString(d,function(c){Wires.Component[a]=c,b(c)});var e=this.sourceElement;if(e){var f=document.querySelector(e);f?Wires.DOM.getFromString(f.innerHTML,function(c){Wires.Component[a]=c,b(c),$(f).remove()}.bind(this)):console.error("Cant fetch element for ",a," with selector ",e)}}},{components:{},componentDom:{},register:function(a,b){this.components[a]=b},searchForComponentDataAttribute:function(a,b){var c=function(a){_.each(a,function(a){_.each(a.attribs,function(c,d){"component-data"===d&&(a.children=b)}),a.children&&c(a.children)})};c(a)},getCustomComponent:function(a){return this.components[a]}})}(),Wires.MVC=Wires.MVC||{},function(){"use strict";Wires.MVC.templateCollection={},Wires.MVC.currentParams,Wires.MVC.createdViews={},Wires.MVC.createdControllers={},Wires.MVC.controllerTemplates={},Wires.MVC.interceptors={},Wires.MVC.registeredControllers=[],Wires.MVC.collectionsInstances={},Wires.MVC.rest={_send:function(a,b){$.ajax({type:a.type,url:a.url,data:JSON.stringify(b),dataType:"json",contentType:"application/json; charset=utf-8",success:a.success,error:function(b){a.error(b)}})},obtain:function(a,b,c){this._send({type:"GET",url:a,success:b,error:c})},post:function(a,b,c){this._send({type:"POST",url:a.url,success:b,error:c},a.data)},put:function(a,b,c){this._send({type:"PUT",url:a.url,success:b,error:c},a.data)},del:function(a,b,c){this._send({type:"DELETE",url:a.url,success:b,error:c},a.data)}},Wires.MVC.ControllerInterceptor=function(a,b){var c=a.interceptors||{},d=[];_.each(c,function(a,b){Wires.MVC.interceptors[b]||(Wires.MVC.interceptors[b]=new a),Wires.MVC.interceptors[b].call&&d.push(function(a){Wires.MVC.interceptors[this.name].call(a)}.bind({name:b}))}),async.waterfall(d,b)},Wires.MVC.getURLParameters=function(){var a=window.location.hash.replace("#","/"),b=a.split("/");b.splice(0,1);var c={controller:b.length>=1?b[0]:"main",action:b.length>=2?b[1]:"index",id:b.length>=3?b[2]:null};return c},Wires.MVC.onHistory=function(a){$(window).on("hashchange",function(){a(Wires.MVC.getURLParameters())})},Wires.MVC.LastOpenedView=null,Wires.MVC.Essentials=function(a,b,c){var d,e=Wires.MVC.getURLParameters(),b=b||"index",f=a.essentials||{},g=f.views||{},h=f.collections||{},i=f.containers?f.containers["*"]||f.containers[b]:"#content",j=g["*"]?g["*"]:g[b]||null,k=[];j&&k.push(function(a){Wires.MVC.fetchTemplate(j,function(b){d=b,a()})}),_.each(h,function(b,c){if(!Wires.MVC.collectionsInstances[c]){var d=new b;Wires.MVC.collectionsInstances[c]=d.getCollection(),k.push(function(a){this.model.fetchAll({success:function(){this.done()}.bind({done:a})})}.bind({model:d}))}a[c]=Wires.MVC.collectionsInstances[c]}),async.waterfall(k,function(){a.__resolveInitialization(),c({tpl:d,container:i,sameView:j===Wires.MVC.LastOpenedView&&_.isEqual(e,Wires.MVC.currentParams),params:e}),Wires.MVC.currentParams=e,Wires.MVC.LastOpenedView=j})},Wires.MVC.ExecuteTarget=function(a,b){a._currentMethod=b,Wires.MVC.Essentials(a,b,function(c){c.sameView||($(c.container).hide(),Wires.World.cleanUp($(c.container)[0])),a[b](c.params,function(){a.attach.bind(a)(c)})})},Wires.MVC.Router=function(){this.routes=[],this.controllers={},this.fetchEssentials=function(a,b){Wires.MVC.Essentials(a,this.params.action,b)},this.register=function(a,b){Wires.MVC.registeredControllers.push({path:a,controller:b}),this.routes.push({path:a?a:"main",controller:b})},this.on404=function(a){this.notFoundController=a},this._start=function(a){var b=this;this.params=a;try{var c=!1;_.each(this.routes,function(d){_.isString(d.path)?d.path===a.controller&&(b.executeController.bind(b)(d),c=!0):b.url.match(d.path)&&(b.executeController.bind(b)(d),c=!0)}),c===!1&&this.notFoundController&&b.executeController.bind(b)({path:"404",controller:this.notFoundController})}catch(d){Wires.Debug.showError(d),console.log("error",d.stack?d.stack:d)}},this.start=function(){this._start(Wires.MVC.getURLParameters()),Wires.MVC.onHistory(this._start.bind(this))},this.createController=function(a,b){if(!Wires.MVC.createdControllers[a.path]){var c=new a.controller;Wires.MVC.createdControllers[a.path]=c}var c=Wires.MVC.createdControllers[a.path];Wires.MVC.ControllerInterceptor(c,function(){b(c)})},this.executeController=function(a){this.createController(a,function(a){a[this.params.action]&&Wires.MVC.ExecuteTarget(a,this.params.action)}.bind(this))}},Wires.MVC.fetchTemplate=function(a,b){Wires.MVC.controllerTemplates[a]?b(Wires.MVC.controllerTemplates[a]):$.get(Wires.Config.viewsFolder+a,function(c){Wires.MVC.controllerTemplates[a]=c,b(c)})},Wires.MVC.Layout=Wires.Class.extend({template:function(a,b,c){var d=this;Wires.MVC.fetchTemplate(a,function(a){$(c).hide(),b.bind(d)(function(b){d.attach.bind(d)({container:c,tpl:a,afterDone:b})})})},attach:function(a){this.beforeRender&&this.beforeRender(Wires.MVC.getURLParameters());var b=a.afterDone||function(){};if(a.sameView)b(),this.afterRender();else{var c=$(a.container);if(c[0]){c.show();{var d=this;new Wires.World({template:a.tpl,scope:{instance:d},target:c[0]})}b(),this.afterRender()}else console.error(a.container,"was not found in DOM"),console.error("Cannot render instance ",this)}},afterRender:function(){var a=this.essentials||{},b=a.components||[],c=b[this._currentMethod]||{},d=this;_.each(c,function(a,b){var c=_.isString(a)?app[a]:a,e=new c;e.render(),d[b]=e})}},{displayName:""}),Wires.MVC.Component=Wires.MVC.Layout.extend({initialize:function(a){this.essentials=this.essentials||{},this.options=a||{},a&&a.container&&(this.essentials.containers={index:a.container});var b=this;_.each(a,function(a,c){b[c]=a}),Wires.MVC.Component.__super__.initialize.apply(this,arguments)},render:function(){Wires.MVC.ExecuteTarget(this,"index")}}),Wires.MVC.Controller=Wires.MVC.Layout.extend({_delayedInitialization:function(a){this.__resolveInitialization=a},initialize:function(){},propertyChanged:function(a,b,c){console.log(b,c)}})}();var Wires=Wires||{};!function(){"use strict";Wires.Collection=Wires.Class.extend({initialize:function(a){this.array=[],this.db=[],this.conditions={},this.size=0,this._fetched=!1,a&&this.addAll(a)},add:function(a){a=a instanceof Wires.Model?a:new Wires.Model(a),a._collection=this,this.db.push(a),this.conditions.where?_.where([a],this.conditions.where).length>0&&this.array.push(a):this.array.push(a),this.updateSize(),this.trigger("model:added",a)},addAll:function(a){var b=this;_.isArray(a)?_.each(a,function(a){b.add(a)}):b.add(a)},refresh:function(){this.where()},_cleanUp:function(){this.array.splice(0,this.array.length)},_setViewResult:function(a){var b=this;this._cleanUp(),_.each(a,function(a){b.array.push(a)})},filter:function(a){if(!a){if(!this.conditions.where)return;a=this.conditions.where}this.conditions.where=a,this._setViewResult(_.where(this.db,a))},findById:function(a){var b=1*a;if(_.isNaN(b)&&(b=a),b){var c=this.where({id:b});if(c.length>0)return c[0]}},where:function(a){return _.where(this.db,a)},sortBy:function(a){this.conditions.sortBy=a,this._setViewResult(_.sortBy(this.array,a))},reset:function(){this._cleanUp();var a=this;this.conditions={},_.each(this.db,function(b){a.array.push(b)})},each:function(a){_.each(this.db,a)},removeWhere:function(a){var b=[],b=_.where(this.db,a);_.each(b,function(a){a.remove()})},remove:function(a){var b=this.db.indexOf(a);this.db.splice(b,1);var c=this.array.indexOf(a);this.array.splice(c,1),this.trigger("model:removed",a),this.updateSize()},removeAll:function(){var a=this,b=_.clone(this.db);_.each(b,function(b){a.remove(b)})},updateSize:function(){this.size=this.array.length},fetch:function(a){var b,c=this;a.force&&this.removeAll(),Wires.MVC.rest.obtain(a.resource,function(d){c._fetched=!0,_.isArray(d)?(b=[],_.each(d,function(b){var b=new a._class(b);b._collection=c,c.array.push(b),c.db.push(b),c.updateSize()})):b=new a._class(d),a.success&&a.success(b),c.trigger("fetch:success",c)},function(){c.trigger("fetch:error",error),a.error&&a.error(error)})}})}();var Wires=Wires||{};!function(){"use strict";Wires.Model=Wires.Class.extend({_settings:{schema:[{id:{}}]},initialize:function(a){this.setHasManyMethods(),this.assign(a),this._fetched=!1,this._form=new Wires.Collection,this._errors=new Wires.Collection,this._settings.parentClass=this.constructor;this._getAttributes()},setCollection:function(a){this._collection=a},setHasManyMethods:function(){var a=this;this.__hasMany={},_.each(this._settings.hasMany,function(b,c){var d=b(),e=new d;a.__hasMany[c]=e,a[c]=e.getCollection()})},fetchMany:function(a){if(this.__hasMany[a]){var b=this.__hasMany[a];b.fetchAll({path:this._settings.resource+"/"+this.id+"/"+a})}},assign:function(a){var b=this;_.each(a,function(a,c){b[c]=a})},validate:function(){},remove:function(a,b){var c=this._getAttributes();this._collection&&this._collection.remove(this),this._settings.resource&&Wires.MVC.rest.del({url:this._settings.resource+"/"+c.id},function(){a?a(self):""},function(){b?b(self):""})},_resetAttributes:function(){var a=this._getAttributes(),b=this;_.each(a,function(a,c){_.isString(b[c])&&(b[c]=null)})},_getAttributes:function(){var a={};if(this._settings.schema){var b=this;_.each(this._settings.schema,function(c,d){void 0!==b[d]?a[d]=b[d]:void 0!==c.defaultValue&&(b[d]=c.defaultValue,a[d]=b[d])})}return a},_triggerServerValidationError:function(a,b){if(a.responseText)try{var c=JSON.parse(a.responseText);400===c.code&&(b._errors.addAll(c),b.trigger("save:blocker",c))}catch(a){}},create:function(){this._errors.removeAll();var a;if(a=this.validate())return this.trigger("save:blocker",a),void this._errors.addAll(a);var b=new this._settings.parentClass(this._getAttributes()),c=this;b.save(function(a){c._collection&&c._collection.add(a),c._resetAttributes()},function(a){c._triggerServerValidationError(a,c)})},save:function(a,b){var c=this;if(this._settings.resource){var d;if(d=this.validate())return this._errors.addAll(d),void this.trigger("save:blocker",d);var e=this._getAttributes();if(void 0===e.id){var c=this;Wires.MVC.rest.post({url:this._settings.resource,data:e},function(b){b.id&&(c.id=b.id),c.trigger("save:success",!0),a?a(c):""},function(a){c.trigger("save:failed",a),b?b(a):"",c._triggerServerValidationError(a,c)})}else Wires.MVC.rest.put({url:this._settings.resource+"/"+e.id,data:e},function(){c.trigger("save:success",!1),a?a(c):""},function(a){c.trigger("save:failed",a),b?b(a):"",c._triggerServerValidationError(a,c)})}},getCollection:function(){return this._collection=this._collection||new Wires.Collection,this._collection},fetchAll:function(a){if(a.force||!this._fetched){var b=this._settings.json||this._settings.resource;a&&a.path&&(b=a.path);var c=this,d=a||{},e=this.getCollection(),c=this;return e.fetch({resource:b,_class:this._settings.parentClass,success:function(){d.success?d.success():null},error:d.error}),c._fetched=!0,e}},fetch:function(a){if(this._settings.resource){var b=new this._settings.parentClass;return Wires.MVC.rest.obtain(this._settings.resource,function(c){b.assign(c),b.trigger("model:fetched",b),a?a(b):""}),b}}})}();var Wires=Wires||{};!function(){"use strict";Wires.DOM=Wires.Class.extend({},{components:{},storage:{},_obtain:function(a,b){var c=new Tautologistics.NodeHtmlParser.DefaultHandler(function(a,c){a?console.log(a):b(c)}),d=new Tautologistics.NodeHtmlParser.Parser(c);d.parseComplete(a)},getFromString:function(a,b,c){c?this.storage[c]?b(this.storage[c]):this._obtain(a,function(a){this.storage[c]=a,b(a)}):this._obtain(a,function(a){b(a)})}})}();var Wires=Wires||{};!function(){"use strict";Wires.Controller=Wires.Class.extend({},{controllers:{},instances:{},getController:function(a,b){this.controllers[a]?(this.instances[a]||(this.instances[a]=new this.controllers[a]),b(this.instances[a])):b(null)},register:function(a,b){this.controllers[a]=b}})}();var Wires=Wires||{};!function(){"use strict";Wires.Connect=Wires.Class.extend({},{executeController:function(a,b,c){Wires.Controller.getController(a,function(d){d?d.index&&d.index({},function(){new Wires.World({template:b,scope:{instance:d},target:c})}):console.error("Controller",a,"was not found!")})},wireControllers:function(){this.bySelector("div[ws-controller]")},bySelector:function(a){var b=document.querySelectorAll(a),c=this;_.each(b,function(a){var b=a.getAttribute("ws-controller"),d=a.innerHTML;$(a).empty(),c.executeController(b,d,a)})}})}();